<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rivally - Crush Your Competition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .gradient-text { background: linear-gradient(90deg, #2563EB, #1E40AF); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .gradient-btn { background: linear-gradient(90deg, #111827 0%, #374151 100%); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #2563EB; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; display: none; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="text-gray-800 antialiased">

<div class="max-w-5xl mx-auto p-4 md:p-8">
    <div class="text-center mb-12 mt-6">
        <h1 class="text-5xl md:text-6xl font-extrabold tracking-tight mb-3">Rivally<span class="text-blue-600">.</span></h1>
        <p class="text-xl text-gray-500 font-medium">Your Product vs. Theirs. Prove you are better.</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10">
        
        <div class="bg-white p-6 rounded-2xl shadow-lg border-t-4 border-blue-600 relative">

            <div class="absolute -top-3 left-6 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide shadow-sm">YOU</div>
            <h2 class="text-2xl font-bold text-gray-900 mb-6 mt-2">Your Product</h2>
            
            <div class="space-y-5">
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Product Name</label>
                    <input id="myName" type="text" placeholder="e.g. SpeedBurger" class="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:bg-white outline-none transition font-medium">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Price</label>
                    <input id="myPrice" type="text" placeholder="e.g. $5 / month" class="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:bg-white outline-none transition">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Key Features (What are you proud of?)</label>
                    <textarea id="myFeatures" rows="3" placeholder="e.g. Free delivery, Organic ingredients, Mobile App..." class="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:bg-white outline-none transition"></textarea>
                </div>
                <div>
                    <label class="block text-xs font-bold text-red-400 uppercase mb-1">Weaknesses (Be honest)</label>
                    <textarea id="myWeaknesses" rows="2" placeholder="e.g. Small team, No marketing budget yet..." class="w-full p-3 bg-red-50 border border-red-100 rounded-xl focus:ring-2 focus:ring-red-300 focus:bg-white outline-none transition"></textarea>
                </div>
            </div>
        </div>

        <div class="bg-white p-6 rounded-2xl shadow-lg border-t-4 border-gray-800 relative">
            <div class="absolute -top-3 left-6 bg-gray-800 text-white text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide shadow-sm">THEM</div>
            <h2 class="text-2xl font-bold text-gray-900 mb-6 mt-2">The Competitor</h2>
            
            <div class="space-y-5">
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Competitor Name</label>
                    <input id="compName" type="text" placeholder="e.g. McDonald's" class="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-gray-500 focus:bg-white outline-none transition font-medium">

                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Competitor Price</label>
                    <input id="compPrice" type="text" placeholder="e.g. $8 / month" class="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-gray-500 focus:bg-white outline-none transition">
                </div>
                <div>

                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Their Features</label>
                    <textarea id="compFeatures" rows="3" placeholder="e.g. Everywhere, Fast service, Famous brand..." class="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-gray-500 focus:bg-white outline-none transition"></textarea>
                </div>
            </div>
        </div>

    </div>

    <div class="mt-8 bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
        <label class="block text-sm font-bold text-gray-900 mb-2">Target Audience (Who buys this?)</label>
        <input id="targetAudience" type="text" placeholder="e.g. Students, Busy Moms, Startup Founders..." class="w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition">

    </div>

    <div class="mt-10 text-center pb-10">
        <button onclick="generateStrategy()" class="gradient-btn text-white font-extrabold py-5 px-12 rounded-2xl shadow-xl hover:scale-105 transform transition duration-200 w-full md:w-auto text-xl tracking-wide">
            ‚ö° GENERATE WINNING STRATEGY
        </button>
        

        <div id="loader" class="loader mt-6"></div>
        <p id="statusMsg" class="text-gray-500 text-sm mt-3 animate-pulse"></p>
        
        <div id="errorBox" class="hidden mt-6 bg-red-100 border border-red-400 text-red-700 px-6 py-4 rounded-xl max-w-2xl mx-auto text-left"></div>
    </div>

    <div id="results" class="hidden mt-4 mb-20 space-y-8 animate-fade-in-up">
        
        <div class="bg-white p-10 rounded-3xl shadow-2xl border-b-8 border-blue-600 text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-400 to-blue-800"></div>
            <h3 class="text-gray-400 uppercase tracking-widest text-xs font-bold mb-4">MARKET DOMINANCE SCORE</h3>
            <div id="scoreValue" class="text-8xl font-black text-gray-900 mb-2 tracking-tighter"></div>
            <p id="scoreText" class="text-xl text-blue-600 font-medium"></p>
        </div>

        <div class="bg-gray-900 p-8 rounded-3xl shadow-xl border border-gray-700 flex flex-col md:flex-row items-center justify-between gap-6">
            <div class="text-left">
                <h3 class="text-white text-xl font-bold">üèÜ Show off this score!</h3>

                <p class="text-gray-400 text-sm mt-1">Add this badge to your site footer. Prove you are the best.</p>
            </div>
            
            <div class="flex flex-col items-center gap-3 w-full md:w-auto">
                 <div class="bg-white border-2 border-blue-600 rounded-lg px-3 py-1 shadow-sm">
                    <span class="font-bold text-gray-900 text-xs">Rivally Score:</span>

                    <span id="previewScore" class="text-blue-600 font-black text-lg ml-1"></span>
                </div>
                
                <div class="relative w-full">
                    <input id="embedCode" readonly class="w-full bg-black text-green-400 font-mono text-xs p-2 pr-16 rounded border border-gray-700 focus:outline-none" value="<a href='...'>Code loading...</a>">

                    <button onclick="copyToClipboard()" class="absolute top-0 right-0 h-full bg-blue-600 hover:bg-blue-500 text-white text-xs font-bold px-3 rounded-r transition">
                        COPY
                    </button>
                    <p id="copyMsg" class="hidden absolute -bottom-5 left-0 text-green-400 text-[10px]">Copied!</p>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="bg-white p-8 rounded-3xl shadow-lg border border-gray-100">
                <h3 class="text-blue-600 uppercase tracking-widest text-sm font-black mb-6">‚öîÔ∏è WINNING STRATEGY</h3>
                <div id="strategyText" class="space-y-4 text-gray-700 leading-relaxed text-lg"></div>
            </div>

            <div class="bg-yellow-50 p-8 rounded-3xl shadow-lg border-l-8 border-yellow-400">
                <h3 class="text-yellow-700 uppercase tracking-widest text-sm font-black mb-6">üí° FATHERLY ADVICE</h3>
                <p id="adviceText" class="text-gray-800 text-xl italic font-serif leading-relaxed"></p>
            </div>
        </div>

        <div class="bg-gray-100 p-8 rounded-3xl shadow-inner">
            <h3 class="text-gray-500 uppercase tracking-widest text-sm font-bold mb-6">üíÄ REALITY CHECK</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h4 class="font-bold text-gray-900 mb-2 flex items-center"><span class="text-red-500 mr-2">‚ö†Ô∏è</span> Threat Assessment</h4>
                    <p id="threatText" class="text-gray-600 text-sm leading-relaxed"></p>
                </div>
                <div>
                    <h4 class="font-bold text-gray-900 mb-2 flex items-center"><span class="text-green-500 mr-2">üéØ</span> Market Gaps</h4>
                    <p id="gapsText" class="text-gray-600 text-sm leading-relaxed"></p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    async function generateStrategy() {

        // Reset UI
        document.getElementById('results').classList.add('hidden');
        document.getElementById('errorBox').classList.add('hidden');
        document.getElementById('loader').style.display = 'block';
        document.getElementById('statusMsg').innerText = "Analyzing competitor weaknesses...";

        // Collect Data

        const data = {
            product_name: document.getElementById('myName').value,
            price: document.getElementById('myPrice').value,
            key_features: document.getElementById('myFeatures').value,
            weaknesses: document.getElementById('myWeaknesses').value,
            target_audience: document.getElementById('targetAudience').value,

            competitor_name: document.getElementById('compName').value,
            competitor_price: document.getElementById('compPrice').value,
            competitor_features: document.getElementById('compFeatures').value
        };

        try {
            // API Call
            const response = await fetch('/generate-rival-strategy', {

                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (!response.ok) throw new Error("Server error");
            const result = await response.json();

            // Populate UI
            document.getElementById('scoreValue').innerText = result.dominance_score;
            document.getElementById('scoreText').innerText = "Dominance Score";
            document.getElementById('strategyText').innerHTML = result.winning_strategy.replace(/\n/g, '<br><br>'); // Better spacing
            document.getElementById('adviceText').innerText = `"${result.fatherly_advice}"`;
            document.getElementById('threatText').innerText = result.reality_check.threat_assessment;
            document.getElementById('gapsText').innerText = result.reality_check.market_gaps_found;

            // --- WIDGET LOGIC ---
            document.getElementById('previewScore').innerText = result.dominance_score;
            const widgetHTML = `<a href="https://rivally.app" target="_blank" style="text-decoration:none;display:inline-flex;align-items:center;background:#fff;border:2px solid #2563EB;border-radius:8px;padding:5px 10px;font-family:sans-serif;box-shadow:0 2px 4px rgba(0,0,0,0.1);"><span style="color:#111827;font-weight:700;font-size:12px;margin-right:5px;">Rivally Score:</span><span style="color:#2563EB;font-weight:900;font-size:16px;">${result.dominance_score}</span></a>`;
            document.getElementById('embedCode').value = widgetHTML;

            // Show Results
            document.getElementById('results').classList.remove('hidden');

        } catch (error) {
            document.getElementById('errorBox').innerText = "Gre≈°ka: Proveri da li je server (main.py) upaljen! " + error.message;
            document.getElementById('errorBox').classList.remove('hidden');
        } finally {
            document.getElementById('loader').style.display = 'none';
            document.getElementById('statusMsg').innerText = "";
        }
    }

    function copyToClipboard() {
        const copyText = document.getElementById("embedCode");
        copyText.select();
        document.execCommand("copy");
        document.getElementById("copyMsg").classList.remove("hidden");
        setTimeout(() => document.getElementById("copyMsg").classList.add("hidden"), 2000);
    }
</script>


</body>

</html>
