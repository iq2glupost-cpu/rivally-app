<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RIVALLY | SAKORP INTELLIGENCE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
       
        body {
            background-color: #000;
            color: #fff;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }

        /* ELEGANTNI OKVIR I NITI */
        .main-container {
            position: relative;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 24px;
            border: 1px solid rgba(37, 99, 235, 0.1);
        }

        .flow-line {
            fill: none;
            stroke: #2563eb;
            stroke-width: 1.5;
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: flowAnim 4s infinite cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(0 0 4px rgba(37, 99, 235, 0.5));
        }

        @keyframes flowAnim {
            to { stroke-dashoffset: 0; }
        }

        .pulsing-glow {
            animation: glowPulse 3s infinite ease-in-out;
        }

        @keyframes glowPulse {
            0%, 100% { border-color: rgba(37, 99, 235, 0.1); box-shadow: 0 0 20px rgba(0,0,0,0); }
            50% { border-color: rgba(37, 99, 235, 0.3); box-shadow: 0 0 30px rgba(37, 99, 235, 0.1); }
        }

        /* MODERNI INPUTI */
        input, textarea {
            background: #0a0a0a !important;
            border: 1px solid #1a1a1a !important;
            border-radius: 8px !important;
            color: #fff !important;
            transition: all 0.3s ease;
        }
        input::placeholder, textarea::placeholder { color: #444; font-size: 13px; }
        input:focus { border-color: #2563eb !important; background: #0c0c0c !important; outline: none; }

        .btn-modern {
            background: linear-gradient(180deg, #2563eb 0%, #1e40af 100%);
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
            transition: all 0.3s;
        }
        .btn-modern:hover { transform: translateY(-1px); box-shadow: 0 8px 25px rgba(37, 99, 235, 0.5); }

        .blur-lock { filter: blur(20px); pointer-events: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col justify-between py-12">

    <header class="text-center mb-12">
        <h1 class="text-5xl font-extrabold tracking-tighter mb-2">RIVALLY</h1>
        <p class="text-zinc-500 text-xs tracking-[0.4em] uppercase font-light">Advanced Market Analysis</p>
    </header>

    <main class="max-w-5xl mx-auto w-full px-6 relative">
       
        <div class="main-container pulsing-glow p-8 md:p-14 relative overflow-hidden">
           
            <svg class="absolute inset-0 w-full h-full pointer-events-none" preserveAspectRatio="none">
                <path class="flow-line" d="M 50% 0 L 40 0 Q 0 0 0 40 L 0 500 Q 0 560 40 560 L 50% 560" />
                <path class="flow-line" d="M 50% 0 L calc(100% - 40) 0 Q 100% 0 100% 40 L 100% 500 Q 100% 560 calc(100% - 40) 560 L 50% 560" />
            </svg>

            <div class="relative z-10 grid grid-cols-1 md:grid-cols-2 gap-12">
                <div class="space-y-6">
                    <h3 class="text-blue-500 font-semibold text-[10px] uppercase tracking-widest mb-6">Internal Designation</h3>
                    <input type="text" id="myName" placeholder="e.g. Project X - Fintech App" class="w-full p-4 text-sm">
                    <input type="text" id="myUrl" placeholder="https://yourcompany.com" class="w-full p-4 text-sm text-blue-400">
                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" id="myPrice" placeholder="e.g. $49 / month" class="p-4 text-sm">
                        <input type="text" id="targetAudience" placeholder="e.g. B2B Enterprise" class="p-4 text-sm">
                    </div>
                    <textarea id="myFeatures" placeholder="Describe your unique value propositions..." class="w-full p-4 h-32 text-sm"></textarea>
                </div>

                <div class="space-y-6 border-l border-white/5 pl-0 md:pl-12">
                    <h3 class="text-zinc-500 font-semibold text-[10px] uppercase tracking-widest mb-6">Competitor Analysis</h3>
                    <input type="text" id="compName" placeholder="e.g. Competitor Brand Name" class="w-full p-4 text-sm">
                    <input type="text" id="compUrl" placeholder="https://rivalapp.io" class="w-full p-4 text-sm text-zinc-400">
                    <input type="text" id="compPrice" placeholder="e.g. Tiered Pricing" class="p-4 text-sm">
                    <textarea id="compFeatures" placeholder="Describe their market position and features..." class="w-full p-4 h-52 text-sm"></textarea>
                </div>
            </div>

            <div class="mt-16 flex justify-center">
                <button onclick="generateStrategy()" id="mainBtn" class="btn-modern px-12 py-5 rounded-full font-bold uppercase tracking-widest text-xs">
                    Initiate Neural Scan
                </button>
            </div>
            <div id="loader" class="hidden text-center mt-6 text-blue-600 text-[10px] tracking-widest animate-pulse">ESTABLISHING CONNECTION...</div>
        </div>

        <div id="results" class="hidden mt-24">
            <div id="lockedContent" class="blur-lock bg-zinc-950/30 p-10 rounded-3xl border border-white/5 relative">
                <div class="flex justify-between items-end border-b border-white/5 pb-8 mb-10">
                    <div>
                        <span class="text-zinc-600 text-[10px] uppercase tracking-widest">Decrypted Analysis</span>
                        <h2 class="text-3xl font-bold mt-2">Strategy Report</h2>
                    </div>
                    <div class="text-right">
                        <div id="scoreValue" class="text-6xl font-black text-blue-600 tracking-tighter">00</div>
                        <p class="text-[9px] uppercase text-zinc-500 tracking-widest">Dominance Index</p>
                    </div>
                </div>
                <div id="strategyText" class="prose prose-invert prose-blue max-w-none text-zinc-400"></div>
            </div>

            <div id="unlockOverlay" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/95 backdrop-blur-2xl p-6">
                <div class="bg-zinc-900/50 border border-white/5 p-12 rounded-3xl max-w-md w-full text-center">
                    <h3 class="text-2xl font-bold mb-2">Analysis Complete</h3>
                    <p class="text-zinc-500 text-xs mb-10 uppercase tracking-widest leading-loose">Enter email to receive the full strategic packet.</p>
                    <input type="email" id="unlockEmail" placeholder="ENTER WORK EMAIL" class="w-full p-4 mb-6 text-center text-xs tracking-widest">
                    <button onclick="unlockContent()" class="w-full bg-blue-600 text-white font-bold py-5 rounded-xl uppercase tracking-widest text-xs hover:bg-blue-500 transition">Unlock & Send Report</button>
                </div>
            </div>
        </div>

    </main>

    <footer class="text-center opacity-30 hover:opacity-100 transition duration-500 cursor-default">
        <div class="flex flex-col items-center gap-3">
            <svg width="25" height="25" viewBox="0 0 60 60" fill="none">
                <path d="M5 5H35V20H20V35H5V5Z" fill="white"/>
                <rect x="20" y="20" width="30" height="15" fill="#2563eb"/>
                <path d="M20 35H50V50H5V35H20Z" fill="white"/>
            </svg>
            <span class="text-[8px] tracking-[0.6em] text-zinc-500 uppercase">Sakorp Systems &copy; 2025</span>
        </div>
    </footer>

    <script>
    let globalResult = null;

    async function generateStrategy() {
        const myName = document.getElementById('myName').value;
        const compName = document.getElementById('compName').value;
        const compUrl = document.getElementById('compUrl').value;
       
        if(!myName || !compName) return alert("Please fill in required fields.");

        const data = {
            my_product: { name: myName, price: document.getElementById('myPrice').value, features: document.getElementById('myFeatures').value },
            competitor_product: { name: compName, price: document.getElementById('compPrice').value, features: document.getElementById('compFeatures').value, url: compUrl },
            target_audience: document.getElementById('targetAudience').value
        };

        document.getElementById('loader').classList.remove('hidden');
        document.getElementById('results').classList.add('hidden');
        document.getElementById('lockedContent').classList.add('blur-lock');
        document.getElementById('unlockOverlay').classList.remove('hidden');

        try {
            const response = await fetch('/generate-rival-strategy', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            globalResult = await response.json();
            document.getElementById('scoreValue').innerText = globalResult.dominance_score;
            document.getElementById('strategyText').innerHTML = globalResult.html_content;
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('loader').classList.add('hidden');
        } catch (error) {
            document.getElementById('loader').classList.add('hidden');
            alert("Uplink Error.");
        }
    }

    async function unlockContent() {
        const email = document.getElementById('unlockEmail').value.trim();
        if (!email.includes('@')) return alert("Valid email required.");

        try {
            await fetch('/save-lead', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: email,
                    score: globalResult.dominance_score || 0,
                    product_name: document.getElementById('myName').value,
                    competitor_name: document.getElementById('compName').value,
                    report_html: globalResult.html_content
                })
            });
        } catch (e) {}

        document.getElementById('lockedContent').classList.remove('blur-lock');
        document.getElementById('unlockOverlay').classList.add('hidden');
    }
    </script>
</body>
</html>
