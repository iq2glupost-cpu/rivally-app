<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RIVALLY | SAKORP INTELLIGENCE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400&family=Space+Grotesk:wght@300;900&display=swap');
        body { font-family: 'Space Grotesk', sans-serif; background-color: #000; color: #fff; }
       
        .deep-blue-glow { box-shadow: 0 0 30px rgba(29, 78, 216, 0.15); border: 1px solid #1e3a8a; }
       
        /* PULSIRAJUĆE NITI */
        .circuit-line {
            fill: none;
            stroke: #1e40af; /* Tamno plava */
            stroke-width: 2;
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: flow 3s infinite linear;
        }
        @keyframes flow { to { stroke-dashoffset: 0; } }

        input, textarea {
            background: #050505 !important;
            border: 1px solid #111 !important;
            color: #fff !important;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px !important;
        }
        input:focus { border-color: #1e40af !important; outline: none; }
       
        .scan-btn {
            background: #1e3a8a; /* Tamno plava */
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #1e40af;
        }
        .scan-btn:hover { background: #1d4ed8; box-shadow: 0 0 40px rgba(29, 78, 216, 0.4); }
        .blur-lock { filter: blur(20px); pointer-events: none; }
    </style>
</head>
<body class="p-4 md:p-10">

    <div class="flex flex-col items-center mb-16">
        <svg width="50" height="50" viewBox="0 0 60 60" fill="none">
            <path d="M5 5H35V20H20V35H5V5Z" fill="white"/>
            <rect x="20" y="20" width="30" height="15" fill="#1e40af"/>
            <path d="M20 35H50V50H5V35H20Z" fill="white"/>
        </svg>
        <h2 class="font-black tracking-[0.6em] text-xs mt-4 opacity-50 uppercase text-blue-800">Sakorp Rivally Unit</h2>
    </div>

    <main class="max-w-5xl mx-auto relative">
       
        <div class="relative p-[2px] rounded-2xl overflow-hidden">
            <svg class="absolute inset-0 w-full h-full pointer-events-none" preserveAspectRatio="none">
                <rect x="1" y="1" width="calc(100% - 2)" height="calc(100% - 2)" rx="16" fill="none" stroke="#0a192f" stroke-width="2" />
               
                <path class="circuit-line" d="M 50% 0 L 30 0 Q 0 0 0 30 L 0 500 Q 0 550 30 550 L 50% 550" />
                <path class="circuit-line" d="M 50% 0 L calc(100% - 30) 0 Q 100% 0 100% 30 L 100% 500 Q 100% 550 calc(100% - 30) 550 L 50% 550" />
            </svg>

            <div class="bg-[#030303] rounded-2xl p-8 md:p-12 deep-blue-glow relative z-10">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 mb-16">
                    <div class="space-y-4">
                        <label class="text-[9px] uppercase tracking-[0.4em] text-zinc-600 block mb-4 italic font-bold">// Target_Asset_YourSite</label>
                        <input type="text" id="myName" placeholder="PROJECT NAME" class="w-full p-4 uppercase tracking-widest">
                        <input type="text" id="myUrl" placeholder="WEB ADDRESS (yoursite.com)" class="w-full p-4 text-blue-900 font-bold">
                        <div class="grid grid-cols-2 gap-4">
                            <input type="text" id="myPrice" placeholder="PRICE POINT" class="p-4 uppercase">
                            <input type="text" id="targetAudience" placeholder="AUDIENCE" class="p-4 uppercase">
                        </div>
                        <textarea id="myFeatures" placeholder="CORE CAPABILITIES" class="w-full p-4 h-32"></textarea>
                    </div>

                    <div class="space-y-4">
                        <label class="text-[9px] uppercase tracking-[0.4em] text-zinc-600 block mb-4 italic font-bold">// Target_Asset_Competitor</label>
                        <input type="text" id="compName" placeholder="RIVAL NAME" class="w-full p-4 uppercase tracking-widest border-red-900/10">
                        <input type="text" id="compUrl" placeholder="RIVAL WEB ADDRESS (rival.com)" class="w-full p-4 text-red-900 font-bold">
                        <input type="text" id="compPrice" placeholder="RIVAL PRICING" class="w-full p-4 uppercase">
                        <textarea id="compFeatures" placeholder="RIVAL REVENUE CHANNELS & FEATURES" class="w-full p-4 h-52"></textarea>
                    </div>
                </div>

                <div class="flex justify-center mt-8">
                    <button id="mainBtn" onclick="generateStrategy()" class="scan-btn w-full max-w-2xl text-white font-black py-6 uppercase tracking-[0.5em] text-xs rounded-sm relative overflow-hidden group">
                        <span class="relative z-10">Initiate Neural Extraction</span>
                        <div class="absolute inset-0 bg-blue-600/10 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                    </button>
                </div>
                <div id="loader" class="hidden mt-6 text-center text-blue-900 font-mono text-[10px] uppercase tracking-widest animate-pulse italic">Connecting to Sakorp Mainframe...</div>
            </div>
        </div>

        <div id="results" class="hidden mt-32">
            <div id="lockedContent" class="blur-lock bg-zinc-950/20 p-10 rounded-2xl border border-white/5">
                <div class="flex flex-col md:flex-row justify-between items-end border-b border-white/5 pb-10 mb-10">
                    <h2 class="text-4xl font-black italic uppercase tracking-tighter">Strategic Audit</h2>
                    <div id="scoreValue" class="text-7xl font-black text-blue-900">--</div>
                </div>
                <div id="strategyText" class="prose prose-invert max-w-none text-zinc-500 text-sm"></div>
            </div>

            <div id="unlockOverlay" class="hidden fixed inset-0 z-[100] flex items-center justify-center bg-black/90 backdrop-blur-3xl p-6">
                <div class="bg-black border border-blue-900/30 p-12 rounded-2xl max-w-md w-full text-center">
                    <h3 class="text-xl font-black italic uppercase tracking-widest mb-6">Packet Compiled</h3>
                    <p class="text-zinc-600 text-[10px] mb-8 uppercase tracking-[0.3em] leading-relaxed">Enter priority email to decrypt and receive full report.</p>
                    <input type="email" id="unlockEmail" placeholder="ENTER EMAIL" class="w-full p-4 mb-4 text-center text-[10px] tracking-[0.4em] uppercase">
                    <button onclick="unlockContent()" class="w-full bg-white text-black font-black py-5 uppercase tracking-[0.4em] text-[10px]">Send & Unlock Report</button>
                </div>
            </div>
        </div>
    </main>

    <script>
    let globalResult = null;

    async function generateStrategy() {
        const myName = document.getElementById('myName').value;
        const compName = document.getElementById('compName').value;
        const compUrl = document.getElementById('compUrl').value;
       
        if(!myName || !compName) return alert("System requires target identification.");

        const data = {
            my_product: { name: myName, price: document.getElementById('myPrice').value, features: document.getElementById('myFeatures').value },
            competitor_product: { name: compName, price: document.getElementById('compPrice').value, features: document.getElementById('compFeatures').value, url: compUrl },
            target_audience: document.getElementById('targetAudience').value
        };

        document.getElementById('loader').style.display = 'block';
        document.getElementById('results').classList.add('hidden');
        document.getElementById('lockedContent').classList.add('blur-lock');
        document.getElementById('unlockOverlay').classList.remove('hidden');

        try {
            const response = await fetch('/generate-rival-strategy', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            globalResult = await response.json();
            document.getElementById('scoreValue').innerText = globalResult.dominance_score + "/100";
            document.getElementById('strategyText').innerHTML = globalResult.html_content;
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('loader').style.display = 'none';
        } catch (error) { document.getElementById('loader').style.display = 'none'; }
    }

    async function unlockContent() {
        const email = document.getElementById('unlockEmail').value.trim();
        if (!email.includes('@')) return alert("Enter valid corporate channel.");

        try {
            await fetch('/save-lead', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: email,
                    score: globalResult.dominance_score || 0,
                    product_name: document.getElementById('myName').value,
                    competitor_name: document.getElementById('compName').value,
                    report_html: globalResult.html_content // Šaljemo i sadržaj za mejl
                })
            });
        } catch (e) {}

        document.getElementById('lockedContent').classList.remove('blur-lock');
        document.getElementById('unlockOverlay').classList.add('hidden');
        window.scrollTo({ top: 1000, behavior: 'smooth' });
    }
    </script>
</body>
</html>
